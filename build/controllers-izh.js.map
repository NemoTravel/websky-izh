{"version":3,"sources":["controllers-izh.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","hideNotAvailableFlightsController","$scope","utils","setFlightsAvailabilityForThisWeek","_","forEach","vm","flights","segment","flight","flightsAtThisWeek","weekDates","currentWeekDate","weekDayNum","push","checkActiveFlightDay","days","date","begin_date","end_date","isAvailableAtThisWeek","filter","item","weekDaysStr","weekDaynum","currentDate","flightBeginDate","flightEndDate","indexOf","isDateInPeriod","this","$watch","angular","bind","newWeekDates","app","directive","controllerAs","bindToController","scope","controller","2","./directives/hideNotAvailableFlights"],"mappings":"CAAA,WAAY,QAASA,GAAEC,EAAEC,EAAEC,GAAG,QAASC,GAAEC,EAAEC,GAAG,IAAIJ,EAAEG,GAAG,CAAC,IAAIJ,EAAEI,GAAG,CAAC,GAAIE,GAAE,kBAAmBC,UAASA,OAAQ,KAAIF,GAAGC,EAAE,MAAOA,GAAEF,GAAE,EAAI,IAAGI,EAAE,MAAOA,GAAEJ,GAAE,EAAI,IAAIK,GAAE,GAAIC,OAAM,uBAAuBN,EAAE,IAAK,MAAMK,GAAEE,KAAK,mBAAmBF,EAAE,GAAIG,GAAEX,EAAEG,IAAIS,WAAYb,GAAEI,GAAG,GAAGU,KAAKF,EAAEC,QAAQ,SAASd,GAAG,GAAIE,GAAED,EAAEI,GAAG,GAAGL,EAAG,OAAOI,GAAEF,GAAGF,IAAIa,EAAEA,EAAEC,QAAQd,EAAEC,EAAEC,EAAEC,GAAG,MAAOD,GAAEG,GAAGS,QAAQ,IAAI,GAAIL,GAAE,kBAAmBD,UAASA,QAAQH,EAAE,EAAEA,EAAEF,EAAEa,OAAOX,IAAID,EAAED,EAAEE,GAAI,OAAOD,GAAE,MAAOJ,OAAOiB,GAAG,SAAST,EAAQU,EAAOJ,GACxe,YAkBA,SAASK,GAAkCC,EAAQC,GAc/C,QAASC,KACLC,EAAEC,QAAQC,EAAGC,QAAS,SAAUC,GAC5B,GAAIC,GAASD,EAAQD,QAAQ,GACzBG,IAECD,KAILL,EAAEC,QAAQC,EAAGK,UAAW,SAAUC,EAAiBC,GAE/CH,EAAkBI,KACdC,EAAqBN,EAAOO,KAAMH,EAC9BD,EAAgBK,KAAMR,EAAOS,WAAYT,EAAOU,aAK5DV,EAAOW,wBAA0BV,EAAkBW,OAAO,SAAUC,GAChE,MAAOA,KACRzB,OAEHW,EAAQY,wBAA0BZ,EAAQD,QAAQc,OAAO,SAAUZ,GAC/D,MAAOA,GAAOW,wBACfvB,UAMX,QAASkB,GAAqBQ,EAAaC,EAAYC,EAAaC,EAAiBC,GACjF,MACmD,KAA/CJ,EAAYK,QAAQ,IAAMJ,EAAa,KACvCtB,EAAM2B,eAAeJ,EAAaC,EAAiBC,GA9C3D,GAAIrB,GAAKwB,IAGT7B,GAAO8B,OAAOC,QAAQC,KAAKH,KAAM,WAE7B,MAAOxB,GAAGK,YAEV,SAAUuB,GAEV/B,MAED,GA7BP,GAAIgC,GAAMH,QAAQjC,OAAO,MAEzBoC,GAAIC,UAAU,0BAA2B,WACrC,OACIC,aAAc,KACdC,kBAAkB,EAClBC,OACIhC,QAAS,IACTI,UAAW,KAEf6B,WAAY,uCAKpBL,EAAIK,WAAW,qCAAsC,SAAU,QAASxC,SAwDlEyC,GAAG,SAASpD,EAAQU,EAAOJ,GACjC,YACAN,GAAQ,0CACLqD,uCAAuC,SAAS","file":"controllers-izh.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\nvar app = angular.module('app');\n\napp.directive('hideNotAvailableFlights', function () {\n    return {\n        controllerAs: 'vm',\n        bindToController: true,\n        scope: {\n            flights: '=',\n            weekDates: '=',\n        },\n        controller: 'hideNotAvailableFlightsController'\n    }\n});\n\n\napp.controller('hideNotAvailableFlightsController', ['$scope', 'utils', hideNotAvailableFlightsController]);\n\nfunction hideNotAvailableFlightsController($scope, utils) {\n    var vm = this;\n\n\n    $scope.$watch(angular.bind(this, function () {\n\n        return vm.weekDates;\n\n    }), function (newWeekDates) {\n\n        setFlightsAvailabilityForThisWeek();\n\n    }, true);\n\n    function setFlightsAvailabilityForThisWeek() {\n        _.forEach(vm.flights, function (segment) {\n            var flight = segment.flights[0],\n                flightsAtThisWeek = [];\n\n            if (!flight) {\n                return;\n            }\n\n            _.forEach(vm.weekDates, function (currentWeekDate, weekDayNum) {\n\n                flightsAtThisWeek.push(\n                    checkActiveFlightDay(flight.days, weekDayNum,\n                        currentWeekDate.date, flight.begin_date, flight.end_date)\n                )\n            });\n\n\n            flight.isAvailableAtThisWeek = !!flightsAtThisWeek.filter(function (item) {\n                return item;\n            }).length;\n\n            segment.isAvailableAtThisWeek = !!segment.flights.filter(function (flight) {\n                return flight.isAvailableAtThisWeek;\n            }).length;\n\n        });\n    }\n\n\n    function checkActiveFlightDay(weekDaysStr, weekDaynum, currentDate, flightBeginDate, flightEndDate) {\n        return (\n            weekDaysStr.indexOf(\"\" + (weekDaynum + 1)) !== -1 &&\n            utils.isDateInPeriod(currentDate, flightBeginDate, flightEndDate)\n        );\n    }\n}\n\n\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\nrequire('./directives/hideNotAvailableFlights');\n},{\"./directives/hideNotAvailableFlights\":1}]},{},[2]);\n"]}